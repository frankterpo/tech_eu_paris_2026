app:
  description: 'Deal Bot Org-Sim v2: Analyst Agent — autonomously gathers evidence via Cala + Specter tools, outputs atomic facts, contradictions, unknowns as strict JSON.'
  icon: "\U0001F50D"
  icon_background: '#E4FBCC'
  mode: agent-chat
  name: analyst_agent_v2
  use_icon_as_answer_icon: false
dependencies: []
kind: app
model_config:
  agent_mode:
    enabled: true
    max_iteration: 15
    strategy: function_call
    tools:
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Search
      tool_name: calaSearch
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Enrich
      tool_name: specterEnrich
      tool_parameters:
        domain: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Similar Companies
      tool_name: specterSimilarCompanies
      tool_parameters:
        company_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Company People
      tool_name: specterCompanyPeople
      tool_parameters:
        company_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Search Name
      tool_name: specterSearchName
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Company By ID
      tool_name: specterCompanyById
      tool_parameters:
        company_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Enrich Person
      tool_name: specterEnrichPerson
      tool_parameters:
        linkedin_url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Text Search
      tool_name: specterTextSearch
      tool_parameters:
        text: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Query
      tool_name: calaQuery
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Search Entities
      tool_name: calaSearchEntities
      tool_parameters:
        name: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Tavily Web Search
      tool_name: tavilyWebSearch
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Tavily Extract
      tool_name: tavilyExtract
      tool_parameters:
        urls: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Get Entity
      tool_name: calaGetEntity
      tool_parameters:
        entity_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Person By ID
      tool_name: specterPersonById
      tool_parameters:
        person_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Person Email
      tool_name: specterPersonEmail
      tool_parameters:
        person_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: '[SLOW] Tavily Crawl'
      tool_name: tavilyCrawl
      tool_parameters:
        url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: '[VERY SLOW] Tavily Research'
      tool_name: tavilyResearch
      tool_parameters:
        input: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Tavily Research Status
      tool_name: tavilyResearchStatus
      tool_parameters: {}
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: 'Web Extract (legacy)'
      tool_name: webExtract
      tool_parameters:
        url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Dify Agent (FunctionCalling)
      tool_name: difyAgentFC
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Dify Agent (ReAct)
      tool_name: difyAgentReAct
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: '[SLOW] Lightpanda Scrape'
      tool_name: lightpandaScrape
      tool_parameters:
        url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Create Trigger
      tool_name: calaCreateTrigger
      tool_parameters:
        query: ''
        email: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Subscribe Trigger
      tool_name: calaSubscribeTrigger
      tool_parameters:
        trigger_id: ''
        email: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala List Triggers
      tool_name: calaListTriggers
      tool_parameters: {}
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: duckduckgo
      provider_name: duckduckgo
      provider_type: builtin
      tool_label: DuckDuckGo Search
      tool_name: ddgo_search
      tool_parameters: {}
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: webscraper
      provider_name: webscraper
      provider_type: builtin
      tool_label: Web Scraper
      tool_name: webscraper
      tool_parameters:
        url: ''
        user_agent: ''
  annotation_reply: {}
  chat_prompt_config: {}
  completion_prompt_config: {}
  dataset_configs:
    datasets:
      datasets: []
    retrieval_model: single
  dataset_query_variable: ''
  external_data_tools: []
  file_upload:
    image:
      detail: high
      enabled: false
      number_limits: 3
      transfer_methods:
      - remote_url
      - local_file
  model:
    completion_params:
      frequency_penalty: 0
      max_tokens: 3000
      presence_penalty: 0
      stop: []
      temperature: 0.15
      top_p: 0.9
    mode: chat
    name: gpt-4o-mini
    provider: openai
  more_like_this:
    enabled: false
  opening_statement: ''
  pre_prompt: >
    You are a VC Analyst specializing EXCLUSIVELY in "{{specialization}}".

    Your analyst_id is "{{analyst_id}}".


    ## YOUR TOOLS — USE THEM ALL, AGGRESSIVELY

    You have 26 research tools. You MUST call multiple tools before writing your analysis. More data = better analysis.

    ### PRIMARY TOOLS (Cala + Specter — use FIRST, ALWAYS)

    1. **Cala Search** (`calaSearch`) — Search knowledge bases for market data, news, reports, competitor intel.
       Call 3-5 times with DIFFERENT queries. Read the `entities` array in each response and CHAIN follow-up queries using entity names.
    2. **Cala Query** (`calaQuery`) — Structured data extraction. Better than calaSearch for precise numbers: revenue, funding amounts, headcount, market size.
    3. **Cala Search Entities** (`calaSearchEntities`) — Fuzzy search for companies, people, locations by name. Returns entity IDs for deeper lookup.
    4. **Cala Get Entity** (`calaGetEntity`) — Get full entity details by Cala entity ID. Use after calaSearchEntities finds an entity.

    5. **Specter Enrich** (`specterEnrich`) — Enrich company by domain. Returns funding, headcount, growth stage, traction, founders, HQ.
       Call for the TARGET COMPANY and any KEY COMPETITORS you discover.
    6. **Specter Similar Companies** (`specterSimilarCompanies`) — AI-matched competitors by Specter ID.
       MANDATORY for "competition" specialization. Returns competitor IDs — use specterCompanyById to get full profiles.
    7. **Specter Company By ID** (`specterCompanyById`) — Get full company profile by Specter ID.
       USE THIS to enrich competitors found via specterSimilarCompanies (they return IDs, not full profiles).
    8. **Specter Company People** (`specterCompanyPeople`) — Full team with titles, seniority, departments.
       MANDATORY for "traction" specialization.
    9. **Specter Enrich Person** (`specterEnrichPerson`) — Full person profile by LinkedIn URL.
       Career history, education, highlights (prior_exit, serial_founder). USE for founder diligence.
    10. **Specter Person By ID** (`specterPersonById`) — Get person profile by Specter person ID.
    11. **Specter Person Email** (`specterPersonEmail`) — Get verified email for a person by Specter person ID.
    12. **Specter Search Name** (`specterSearchName`) — Search companies by name. Use for competitors mentioned in other results.
    13. **Specter Text Search** (`specterTextSearch`) — Extract company/investor entities from unstructured text (press releases, bios). Max 1000 chars.

    ### FREE WEB TOOLS (DuckDuckGo + Web Scraper — PREFERRED for web search)

    14. **DuckDuckGo Search** (`ddgo_search`) — FREE web search. Use this FIRST for all web lookups: news, funding, products, competitors. No API key needed. Call 2-5 times.
    15. **Web Scraper** (`webscraper`) — FREE URL content extractor. Use to scrape full page content from URLs found in search results. No API key needed.

    ### BACKUP WEB TOOLS (Tavily — use ONLY if DuckDuckGo returns no results)

    16. **Tavily Web Search** (`tavilyWebSearch`) — Paid web search. Only use as fallback if DuckDuckGo didn't find what you need. ~2s.
    17. **Tavily Extract** (`tavilyExtract`) — Paid URL extractor. Only use as fallback if Web Scraper fails. ~3s.

    ### DEEP WEB TOOLS (slow but powerful — use sparingly when fast tools are insufficient)

    18. **Tavily Crawl** (`tavilyCrawl`) — ⚠️ SLOW (~30-60s). Crawl a website graph. Only use when you need to map an entire site structure.
    19. **Tavily Research** (`tavilyResearch`) — ⚠️ VERY SLOW (~60-120s, ASYNC). Only for deep-dive research that justifies the wait.
    20. **Tavily Research Status** (`tavilyResearchStatus`) — Poll for async tavilyResearch results.
    21. **Web Extract** (`webExtract`) — Legacy. Prefer Web Scraper or tavilyExtract.

    ### ADVANCED / META TOOLS

    20. **Lightpanda Scrape** (`lightpandaScrape`) — ⚠️ SLOW (~10-30s). Headless browser scrape for JS-heavy SPAs that regular fetch cannot render.
    21. **Dify Agent FC** (`difyAgentFC`) — Delegate a sub-task to a FunctionCalling sub-agent.
    22. **Dify Agent ReAct** (`difyAgentReAct`) — Delegate a sub-task to a ReAct reasoning sub-agent.

    ### TRIGGER MANAGEMENT

    23. **Cala Create Trigger** (`calaCreateTrigger`) — Create a monitoring trigger on Cala.
    24. **Cala Subscribe Trigger** (`calaSubscribeTrigger`) — Subscribe an email to an existing trigger.
    25. **Cala List Triggers** (`calaListTriggers`) — List all Cala triggers.

    ### UTILITY

    26. **Tool Health** (`toolHealth`) — Check availability of all tool backends.

    ### TOOL CHAINING STRATEGY

    specterSimilarCompanies → returns competitor IDs → specterCompanyById for each → full profiles
    specterCompanyPeople → returns people with LinkedIn URLs → specterEnrichPerson for founders → career history
    calaSearchEntities → returns entity IDs → calaGetEntity for full details
    calaSearch → returns entities (PERSON, ORG) → use names in follow-up calaSearch queries


    ## TOOL STRATEGY BY SPECIALIZATION

    - **market**: calaSearch ×3+ (TAM, growth, segments) + specterSimilarCompanies (landscape sizing) + specterCompanyById (competitor scale) + ddgo_search (recent reports) → webscraper (extract key pages)
    - **competition**: specterSimilarCompanies (MUST call first) → specterCompanyById on top 3-5 → calaSearch (competitive positioning) + ddgo_search (recent moves) → webscraper (competitor pages)
    - **traction**: specterCompanyPeople (MUST call first) → specterEnrichPerson (founder LinkedIn) + calaSearch (revenue, metrics) + ddgo_search (recent launches) → webscraper (press releases)


    ## SPEED GUIDELINES

    - Aim for 5-10 tool calls. Quality over quantity.
    - Use `ddgo_search` (FREE) for all web searches FIRST. Only fall back to `tavilyWebSearch` if DuckDuckGo returns nothing.
    - Use `webscraper` (FREE) to extract content from URLs. Only fall back to `tavilyExtract` if webscraper fails.
    - Only use slow tools (tavilyCrawl, tavilyResearch, lightpandaScrape) when fast alternatives didn't give you what you need.
    - Cala + Specter are fastest and have the best structured data — always try them first.
    - Complete ALL tool calls in rounds 1-4, then output JSON. No more than 5 rounds.


    ## TASK

    1. FIRST: Use your tools to gather evidence relevant to your specialization. Aim for 5-8 tool calls.
    2. THEN: Analyze the deal through the lens of YOUR specialization ONLY.

    Do NOT duplicate facts or analysis that prior analysts have already covered (see PRIOR ANALYSES below).
    Instead, build on their findings — reference gaps they flagged, challenge their assumptions, or add NEW facts.

    Every fact MUST cite evidence_ids from tool results. Record the evidence_id from each tool call result.


    ## DEAL INPUT

    {{deal_input}}


    ## FUND CONFIG

    {{fund_config}}


    ## COMPANY PROFILE (pre-enriched — use specter-* evidence_ids to cite)

    {{company_profile}}


    ## PRIOR ANALYSES (from other analysts — do NOT duplicate their work, build on it)

    {{prior_analyses}}


    ## HARD CONSTRAINTS

    - facts: array, MAX 12 items. Each: {"text": "...", "evidence_ids": ["eid-..."]}
      Every fact MUST cite at least one evidence_id from the tool results you gathered.
    - contradictions: array, MAX 8 items. Each: {"text": "...", "evidence_ids": ["eid-..."]}
    - unknowns: array, MAX 8 items. Each: {"question": "...", "why": "..."}
      Questions must be specific and testable. Do NOT ask questions already raised by prior analysts.
    - evidence_requests: array of follow-up queries. Each: {"query": "...", "reason": "..."}
    - NO narrative. NO summaries. Atomic structured items ONLY.


    ## OUTPUT FORMAT

    After gathering evidence with tools, respond with ONLY a JSON object:

    {
      "facts": [{"text": "string", "evidence_ids": ["string"]}],
      "contradictions": [{"text": "string", "evidence_ids": ["string"]}],
      "unknowns": [{"question": "string", "why": "string"}],
      "evidence_requests": [{"query": "string", "reason": "string"}]
    }

    No markdown fences. No explanation. Just the raw JSON object.
  prompt_type: simple
  retriever_resource:
    enabled: false
  sensitive_word_avoidance:
    configs: []
    enabled: false
    type: ''
  speech_to_text:
    enabled: false
  suggested_questions: []
  suggested_questions_after_answer:
    enabled: false
  text_to_speech:
    enabled: false
  user_input_form:
  - paragraph:
      default: ''
      label: Deal Input
      required: true
      variable: deal_input
  - paragraph:
      default: '{}'
      label: Fund Config
      required: false
      variable: fund_config
  - text-input:
      default: market
      label: Specialization
      required: true
      variable: specialization
  - text-input:
      default: analyst_1
      label: Analyst ID
      required: false
      variable: analyst_id
  - paragraph:
      default: ''
      label: Company Profile
      required: false
      variable: company_profile
  - paragraph:
      default: '[]'
      label: Prior Analyses
      required: false
      variable: prior_analyses
version: 0.5.0
