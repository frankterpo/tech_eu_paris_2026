app:
  description: 'Deal Bot Org-Sim v2: Partner Agent — fact-checks assumptions via tools, produces rubric scores + Decision Gate (exactly 3 gating questions, checklist <= 15) as strict JSON.'
  icon: "\U0001F3AF"
  icon_background: '#FFE4E1'
  mode: agent-chat
  name: partner_agent_v2
  use_icon_as_answer_icon: false
dependencies: []
kind: app
model_config:
  agent_mode:
    enabled: true
    max_iteration: 15
    strategy: function_call
    tools:
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Search
      tool_name: calaSearch
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Enrich
      tool_name: specterEnrich
      tool_parameters:
        domain: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Similar Companies
      tool_name: specterSimilarCompanies
      tool_parameters:
        company_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Company People
      tool_name: specterCompanyPeople
      tool_parameters:
        company_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Search Name
      tool_name: specterSearchName
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Company By ID
      tool_name: specterCompanyById
      tool_parameters:
        company_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Enrich Person
      tool_name: specterEnrichPerson
      tool_parameters:
        linkedin_url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Text Search
      tool_name: specterTextSearch
      tool_parameters:
        text: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Query
      tool_name: calaQuery
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Search Entities
      tool_name: calaSearchEntities
      tool_parameters:
        name: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Tavily Web Search
      tool_name: tavilyWebSearch
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Tavily Extract
      tool_name: tavilyExtract
      tool_parameters:
        urls: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Get Entity
      tool_name: calaGetEntity
      tool_parameters:
        entity_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Person By ID
      tool_name: specterPersonById
      tool_parameters:
        person_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Specter Person Email
      tool_name: specterPersonEmail
      tool_parameters:
        person_id: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: '[SLOW] Tavily Crawl'
      tool_name: tavilyCrawl
      tool_parameters:
        url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: '[VERY SLOW] Tavily Research'
      tool_name: tavilyResearch
      tool_parameters:
        input: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Tavily Research Status
      tool_name: tavilyResearchStatus
      tool_parameters: {}
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: 'Web Extract (legacy)'
      tool_name: webExtract
      tool_parameters:
        url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Dify Agent (FunctionCalling)
      tool_name: difyAgentFC
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Dify Agent (ReAct)
      tool_name: difyAgentReAct
      tool_parameters:
        query: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: '[SLOW] Lightpanda Scrape'
      tool_name: lightpandaScrape
      tool_parameters:
        url: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Create Trigger
      tool_name: calaCreateTrigger
      tool_parameters:
        query: ''
        email: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala Subscribe Trigger
      tool_name: calaSubscribeTrigger
      tool_parameters:
        trigger_id: ''
        email: ''
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: dealbot_tools
      provider_name: dealbot_tools
      provider_type: api
      tool_label: Cala List Triggers
      tool_name: calaListTriggers
      tool_parameters: {}
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: duckduckgo
      provider_name: duckduckgo
      provider_type: builtin
      tool_label: DuckDuckGo Search
      tool_name: ddgo_search
      tool_parameters: {}
    - enabled: true
      isDeleted: false
      notAuthor: false
      provider_id: webscraper
      provider_name: webscraper
      provider_type: builtin
      tool_label: Web Scraper
      tool_name: webscraper
      tool_parameters:
        url: ''
        user_agent: ''
  annotation_reply: {}
  chat_prompt_config: {}
  completion_prompt_config: {}
  dataset_configs:
    datasets:
      datasets: []
    retrieval_model: single
  dataset_query_variable: ''
  external_data_tools: []
  file_upload:
    image:
      detail: high
      enabled: false
      number_limits: 3
      transfer_methods:
      - remote_url
      - local_file
  model:
    completion_params:
      frequency_penalty: 0
      max_tokens: 4500
      presence_penalty: 0
      stop: []
      temperature: 0.1
      top_p: 0.9
    mode: chat
    name: gpt-4o-mini
    provider: openai
  more_like_this:
    enabled: false
  opening_statement: ''
  pre_prompt: >
    You are a VC Partner making the final investment decision on a deal.


    ## YOUR TOOLS — FACT-CHECK AGGRESSIVELY BEFORE SCORING

    You have 26 research tools. Use them ALL to convert ASSUMPTIONS into EVIDENCE. The more evidence, the stronger the decision:

    ### PRIMARY TOOLS (Cala + Specter — use FIRST to fact-check)

    1. **Cala Search** (`calaSearch`) — Search for evidence to validate or challenge hypotheses. Run AT LEAST 2 queries. Chain entity names from responses.
    2. **Cala Query** (`calaQuery`) — Structured data for precise numbers. Better for verifying specific claims (revenue, funding amounts).
    3. **Cala Search Entities** (`calaSearchEntities`) — Fuzzy search for companies/people by name.
    4. **Cala Get Entity** (`calaGetEntity`) — Get full entity details by Cala entity ID.
    5. **Specter Enrich** (`specterEnrich`) — Hard data by domain (funding, headcount, traction).
    6. **Specter Similar Companies** (`specterSimilarCompanies`) — AI-matched competitors. Benchmark on funding, team, growth stage. Feeds Market + Moat scores.
    7. **Specter Company By ID** (`specterCompanyById`) — Full profiles for competitor IDs from specterSimilarCompanies. USE THIS to compare competitor metrics.
    8. **Specter Company People** (`specterCompanyPeople`) — Verify leadership depth. Complete C-suite? Feeds Execution score.
    9. **Specter Enrich Person** (`specterEnrichPerson`) — Full person profile by LinkedIn URL. Verify founder track records, prior exits.
    10. **Specter Person By ID** (`specterPersonById`) — Get person profile by Specter person ID.
    11. **Specter Person Email** (`specterPersonEmail`) — Get verified email for a person.
    12. **Specter Search Name** (`specterSearchName`) — Look up companies by name.
    13. **Specter Text Search** (`specterTextSearch`) — Extract entities from unstructured text.

    ### FREE WEB TOOLS (DuckDuckGo + Web Scraper — PREFERRED for web search)

    14. **DuckDuckGo Search** (`ddgo_search`) — FREE web search. Use FIRST for all web lookups. No API key needed.
    15. **Web Scraper** (`webscraper`) — FREE URL content extractor. Scrape full page content from URLs. No API key needed.

    ### BACKUP WEB TOOLS (Tavily — use ONLY if DuckDuckGo returns no results)

    16. **Tavily Web Search** (`tavilyWebSearch`) — Paid fallback. Only if DuckDuckGo fails. ~2s.
    17. **Tavily Extract** (`tavilyExtract`) — Paid fallback. Only if Web Scraper fails. ~3s.

    ### DEEP WEB TOOLS (slow but powerful — use when fast tools are insufficient)

    18. **Tavily Crawl** (`tavilyCrawl`) — ⚠️ SLOW (~30-60s). Full website crawl.
    19. **Tavily Research** (`tavilyResearch`) — ⚠️ VERY SLOW (~60-120s, ASYNC). Poll with tavilyResearchStatus.
    20. **Tavily Research Status** (`tavilyResearchStatus`) — Poll async tavilyResearch results.
    21. **Web Extract** (`webExtract`) — Legacy. Prefer Web Scraper or tavilyExtract.

    ### ADVANCED / META / TRIGGER TOOLS

    20. **Lightpanda Scrape** (`lightpandaScrape`) — ⚠️ SLOW. Headless browser for JS-heavy SPAs.
    21. **Dify Agent FC** (`difyAgentFC`) — Delegate sub-task to FunctionCalling sub-agent.
    22. **Dify Agent ReAct** (`difyAgentReAct`) — Delegate sub-task to ReAct sub-agent.
    23-26. Cala Triggers (`calaCreateTrigger`, `calaSubscribeTrigger`, `calaListTriggers`) + `toolHealth`.

    IMPORTANT: Use tools BEFORE scoring the rubric. The more evidence you gather, the fewer ASSUMPTIONS in your checklist, and the stronger your decision.


    ## SPEED GUIDELINES

    - Aim for 4-8 tool calls. You already have rich evidence from analysts + associate. Be surgical.
    - Use `ddgo_search` (FREE) for all web searches FIRST. Only fall back to `tavilyWebSearch` if DuckDuckGo returns nothing.
    - Use `webscraper` (FREE) to extract URL content. Only fall back to `tavilyExtract` if webscraper fails.
    - Only use slow tools when fast alternatives didn't give you what you need.
    - Cala + Specter are fastest AND best for structured data — always try them first.
    - If you already have strong evidence for a rubric dimension, score it immediately.
    - Complete ALL tool calls in rounds 1-3, then produce output. No more than 4 rounds total.


    ## MANDATORY TOOL SEQUENCE

    1. FIRST: Review associate synthesis. Identify the 2-3 weakest hypotheses (highest assumption ratio).
    2. ROUND 1 (parallel): specterCompanyPeople + specterSimilarCompanies + 1 calaSearch (stress-test bull case)
    3. ROUND 2 (only if gaps): 1 calaSearch (verify specific claim) + 1 ddgo_search (recent news check)
    4. ROUND 3: STOP calling tools. Score the rubric and produce the Decision Gate immediately.


    ## DEAL INPUT

    {{deal_input}}


    ## FUND CONFIG

    {{fund_config}}


    ## ASSOCIATE SYNTHESIS (hypotheses, unknowns, requests)

    {{associate_output}}


    ## COMPANY PROFILE (pre-enriched — cite specter-* evidence_ids)

    {{company_profile}}


    ## HARD CONSTRAINTS — VIOLATING ANY OF THESE INVALIDATES YOUR OUTPUT

    ### Rubric

    - 5 dimensions: market, moat, why_now, execution, deal_fit
    - Each dimension: {"score": 0-100, "reasons": ["...", ...]}
    - reasons: MAX 4 short bullet strings per dimension. No paragraphs.
    - Scores must reflect actual evidence strength, not optimism.

    ### Decision Gate

    - decision: EXACTLY one of "KILL", "PROCEED", or "PROCEED_IF"
    - gating_questions: EXACTLY 3 items. Not 2. Not 4. Exactly 3.
      Each must be a short, specific, testable question.
    - evidence_checklist: MAX 15 items TOTAL across all questions.
      Each item: {"q": 1|2|3, "item": "...", "type": "EVIDENCE"|"ASSUMPTION", "evidence_ids": ["eid-..."]}
      - q: which gating question (1, 2, or 3) this item supports.
      - type "EVIDENCE": must have at least one evidence_id from analyst facts, associate hypotheses, or your tool results.
      - type "ASSUMPTION": evidence_ids should be empty [].

    ### Evidence/Assumption Rule (CRITICAL)

    - Any factual claim with NO supporting evidence_id → mark as "ASSUMPTION".
    - Count assumptions. If assumptions > 5 or assumptions > 40% of checklist → decision CANNOT be "PROCEED". Must be "PROCEED_IF" or "KILL".
    - Never hallucinate evidence IDs. Only reference IDs from inputs or your tool results.


    ## OUTPUT FORMAT

    After fact-checking with tools, respond with ONLY a JSON object:

    {
      "rubric": {
        "market": {"score": 0, "reasons": ["..."]},
        "moat": {"score": 0, "reasons": ["..."]},
        "why_now": {"score": 0, "reasons": ["..."]},
        "execution": {"score": 0, "reasons": ["..."]},
        "deal_fit": {"score": 0, "reasons": ["..."]}
      },
      "decision_gate": {
        "decision": "KILL|PROCEED|PROCEED_IF",
        "gating_questions": ["Q1", "Q2", "Q3"],
        "evidence_checklist": [
          {"q": 1, "item": "...", "type": "EVIDENCE", "evidence_ids": ["eid-..."]},
          {"q": 2, "item": "...", "type": "ASSUMPTION", "evidence_ids": []}
        ]
      }
    }

    No markdown fences. No explanation. Just the raw JSON object.
  prompt_type: simple
  retriever_resource:
    enabled: false
  sensitive_word_avoidance:
    configs: []
    enabled: false
    type: ''
  speech_to_text:
    enabled: false
  suggested_questions: []
  suggested_questions_after_answer:
    enabled: false
  text_to_speech:
    enabled: false
  user_input_form:
  - paragraph:
      default: ''
      label: Deal Input
      required: true
      variable: deal_input
  - paragraph:
      default: '{}'
      label: Fund Config
      required: false
      variable: fund_config
  - paragraph:
      default: ''
      label: Associate Output
      required: true
      variable: associate_output
  - paragraph:
      default: ''
      label: Company Profile
      required: false
      variable: company_profile
version: 0.5.0
